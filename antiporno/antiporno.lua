--[[
antiporno.lua v 0.3
(c) Shurik, 2009-2011
Специально для Corbina Central Hub
Может распространяться только по условиям лицензии GNU GPL версии 3.0 или выше.
//Specially for Corbina Central Hub//
//May be redistributed only under terms of GNU GPL version 3.0 or higher.//

* Введение *

Создан специально для Corbina Central Hub.

Скрипт изначально предназначался для технической реализации запрета порнофайлов на хабе, но реально может использоваться
для запрета любых файлов, например, запрещённых к распространению законом, вирусов, а также если от провайдера вдруг
потребуют действий какие-то правоприхлебатели (пользуюсь случаем, хочу выразить огромный низачот Мекмамбетову *здесь
можно подставить несколько матерных слов*).

В коде скрипта есть небольшой список запрещённых TTH, которые будут загружены в базу при первом запуске.

* Справка *

В Билайне (Corbina+Golden) каждый клиент имеет внутрений адрес 10.* и с помощью VPN получает динамический внешний.
На хаб все клиенты ходят по локалке, но некоторых хаб видит по внутреним адресам, а некоторых - по внешним, но при этом
этот внешник отличается от адреса VPN-подключения и является общим для всех юзеров того города, в котором находится
этот клиент.

В связи с этим скрипт банит клиентов с IP вида 10.* по нику и IP, а с внешними IP - только по нику. Конечно, пользователь
может поменять ник, но избежать повторного бана это не поможет. Изменить это поведение можно с помощью переменной
ban_strategy. Чтобы изменить определение "локальный пользователь", надо исправить функцию LAN.

* Как это работает *

Обнаружение запрещённых файлов работает через анализ ответов на пассивный поиск. Есть идея время от времени автоматически 
распространять на хабе пассивный поиск от левого ника. Пока что скрипт фактически реагирует на поиски обычных юзеров или
на случайное попадание по имени файла/TTH при поиске что-нибудь безобидного. Бот сообщает об автобанах всем операторам
хаба.

Кроме того, в скрипте предусмотрен ручной бан для операторов. Его удобно выполнять через менюшки прямо в поиске. Например,
в моём скрипте verlimenu.lua это сделано так:

  if class >= 3 then
    MenuOpt2(nick, 12, "Бан за порно (3 дня)", "!banporno %[userNI] %[fileFN]")
    MenuOpt2(nick, 12, "Бан за вирус (3 дня)", "!banvirus %[userNI] %[fileFN]")
    MenuOpt2(nick, 12, "Бан за фейк (3 дня)", "!banfake %[userNI] %[fileFN]")
    MenuOpt2(nick, 12, "Бан по требованию правообладателя (3 часа)", "!banch %[userNI] %[fileFN]")
    MenuOpt2(nick, 12, "Бан запрещённого файла (3 дня)", "!banforbidden %[userNI] %[fileFN]")
    MenuDiv(nick, 12)
    MenuOpt2(nick, 12, "Добавить в запрещённые как порно", "!addtth %[fileTR] 1 %[fileFN]")
    MenuOpt2(nick, 12, "Добавить в запрещённые как вирус", "!addtth %[fileTR] 2 %[fileFN]")
    MenuOpt2(nick, 12, "Добавить в запрещённые как запрещённый правообладателем", "!addtth %[fileTR] 4 %[fileFN]")
    MenuOpt2(nick, 12, "Добавить в запрещённые как запрещённый", "!addtth %[fileTR] 5 %[fileFN]")
  end

Кроме того, в версии 0.3 появилось новое понятие - ключ файла FK (File Key). При автобане ключ указывается в причине
бана, что существенно облегчает обработку жалоб на ошибочные баны.

* Что скрипт не умеет *

Скрипт не умеет и никогда не научится скачивать файл-листы. Скрипт не может отследить порно у пассивных клиентов, так как
по ним поиск не происходит.

* Команды

  !banporno/!banvirus/!banfake/!banch/!banforbid ник имя_файла
    Наказывает пользователя за порно/вирус/фейк/запрещённый CH/просто запрещённый файл.

  !re/!reload
    Скрипт реагирует также на эту стандартную команду хаба и перегружает список TTH из базы (полезно, если TTH были добавлены
    каким-нибудь сторонним способом напрямую в базу).

  !checktth TTH
    Проверяет TTH на наличие в базе запрещённых

  !checkfk FK
    Проверяет FK на наличие в базе запрещённых

  !addtth TTH тип комментарий
    Добавляет TTH в базу. Тип указывается числом от 1 до 5, комментарий необязателен.

  !deltth TTH
    Удаляет TTH из базы

  !stat
    Статистика

]]--

-- Путь к CFL (отредактируйте при необходимости)
dofile("/etc/verlihub/scripts/functions.lua.inc")

-- Параметры для отладки
debug = false
admin = "Shurik"

-- Типы TTH
badtypes = {
[1] = "порно",
[2] = "вирус",
[3] = "фейк",
[4] = "по требованию правообладателя",
[5] = "запрещённый файл",
}

-- Сообщение, которое будет присутствовать в причине бана
badmsg = {
[1] = "Порно в шаре",
[2] = "Вирус в шаре",
[3] = "Фейк в шаре (название файла не соответствует содержанию либо содержит лишние слова)",
[4] = "Запрещено по требованию правообладателя",
[5] = "Запрещённый файл"
}

-- Время бана в секундах
badtime = {
[1] = 3*24*60*60,
[2] = 3*24*60*60,
[3] = 3*24*60*60,
[4] = 3*60*60, -- правоприхлебатели перебьются, бан будет коротким
[5] = 3*24*60*60
}

--[[
Настройка на бан по нику/IP
0 - Бан ник+IP всех пользователей
1 - Бан ник+IP только локальных пользователей, бан по нику для внешних
2 - Бан только по нику всех пользователей
]]--
ban_strategy = 1

-- URL сайта для проверки TTH
-- Для отключения следует установить равным nil
info_url="http://dc.proisk.ru/?tiger="
--info_url="http://dcstat.proisk.ru/?tth="
--info_url="http://dcmagnets.ru/index.php?do=search&titleonly=4&story="
--info_url=nil

-- Минимальный класс операторов, которому будет доступен мониторинг автобанов
-- (то есть будет приходить флуд от бота)
min_class_autoban = 3

-- Минимальный класс операторов, которому будут доступны команды addtth,deltth,checktth/checkfk,stat
min_class_addtth = 3
min_class_deltth = 3
min_class_checktth = 3
min_class_stat = 3

-- db table
tth_tbl = "porno_tth"

--[[
Начальная коллекция запрещёных файлов. Обратите внимание, что всё это будет автоматом загружено в базу
при первом запуске скрипта, дальше следует пользоваться командой !addtth - для добавления TTH этот массив
менять не нужно!
]]--
badtthinit = {
["54IREYP63DZPUQR7FPQAHXYXTUTJGG7XREDH72I"] = 1,
["5FULLJDRAYXSPDKBHCEA3LKNJ656W2VJ7YQH23A"] = 1,
["UGPFKB4DF5YU4WMV4SM5R3Y4AV456JNZQ6QV35Y"] = 1,
["KGRJXW4NFYEF4HDMV2Q34P3UFKXQVKD52FRUAMA"] = 1,
["T3U5RROH7YQTBAOAPAKMJU4EFOE2PCPQEDYKNCI"] = 1,
["XUCL567RBN4TP3UJTLUG3G4T554ALV4KEXD4YJQ"] = 1,
["UQJGW3EC5GWMPEVZAC2DUNYFJQH45KNPABR3YKQ"] = 1,
["PO6DGUALNFKU6VHIOCFI6RAUEME6THI5HEYDJUY"] = 1,
["S7QMZEYYSKK4WT5Z7HTLT2JXFUIXPUGDBCWKDGA"] = 1,
["SI4X6YXQN3BNMSCKXJ5EB6SXBX5LH4BLXPKA6TA"] = 1,
["NGRLREZ7TOQHJTXIDBADBAM4XSB2CG3MY6JH4HA"] = 1,
["EESTZQPI6EU6EF5FI7JBHH3HNXKZFGSYSB2M6PI"] = 1,
["MPF7RE3OX4FPZ5KB6CDHWVMSRS2OCD5GTMP3H7Y"] = 1,
["JO2ZHAXENJQV3UDRWST47MKEVZSDIAYCC4QGCSI"] = 1,
["CFG4KPHH6HWN2P3JBDNWDBYC44LEWAHH6JLDONI"] = 1,
["DAZVAZMLQBUJTX7VPDBPN56AVAVVZVTOZHNJCCQ"] = 1,
["AGTZBJLHABVU3IPXOXBFB5U2KU37QYPO5MVU4SI"] = 1,
["4W3LNNCYV37HTGRDRORTK54FP2K2XXFVESEGDDQ"] = 1,
["ELJSVI5TUHEZYFSQTZFXKDY5IOYNLLE5HAMX3RQ"] = 1,
["QADT2PNCX5POIBVEL3DLK5MBREUN5RHIHMYG7UI"] = 1,
["AWLJRZDJCNJXCED6A2LAWUGDFDBKM2UP4KBUARA"] = 1,
["S7CV7JD7XNI75CPXCI2XQL4SFBIFDELWUR5SZBI"] = 1,
["AIGMR3SOXNLSZOVNWMSPRHBZUKHQFCUGGIO62BI"] = 1,
["TXVSBJTJAGVS6XMX6FQVRRBNZHQSUOLKMQ5S6QI"] = 1,
["WNGFEJBSDRF26QHJG4DRMWBBBRL7PS43QK3WISA"] = 1,
["TTW7LP2N5G57SNPTQQY3YTO743XQWY4SHYUFMVA"] = 1,
["PLEXMA7JIISN2U7FY6ZG3L64SJD3T7IABB6OWFI"] = 1,
["3WL6QRDA4ZZWUWGBCEGK5IEGMQ3FZA4WUSXTU5A"] = 1,
["NDTBXKLAKDSV7WZ45VPMQYOKSJBCKZZVV2F3YBI"] = 1,
["KTOPFIK5LWPW4BVJKAANAS5737JGTCCGOABC6OY"] = 1,
["YA7YL7E3LU34SSZ4C2WGVVTCMBTXFSLGZBKZYZA"] = 1,
["WISPO455EV44TMYPQNFEVNAZFBGKIC3XLVOAGFI"] = 1,
["N57KPWIRW2O7U26GNR6CB72YB577PHIOZIUSCHY"] = 1,
["6T3GJSUE7NRAK67EKGL5WYRUVN4PZJG5JMNBKVA"] = 1,
["WVYBUL6RPAGG4OWDZQHCCU4FRNBB2GD5Y5K5PXA"] = 1,
["NL4YKJXLZZM62QHOQOJBIM5S7WDKTVD63RPMYVQ"] = 1,
["SA3MUO5SX6OF6G7FEX7EWZEHIPJOIVKT6ND75XI"] = 1,
["ZHMLMGEREEXNX4F7C3DMHXPNH3427S4TER6UBWI"] = 1,
["NE5UJZLSTX5KA3SQ7WQY2D3FNTZXIR4MHAQI7OQ"] = 1,
["CEQXR5QKLP3MWU6GNQVJBIK2EJZKSXEVS22KP5A"] = 1,
["BOTR3RLBJIHIW7IUBG5GFYJHGBNVJPHNNVTA7CA"] = 1,
["R5P5YU7UDFWU2CCIFTGUPPQOKSKPBZPSJMOPVBI"] = 1,
["OILK7OBNQOB652TCO4LXHTNYUAJLZNKO7STZTQI"] = 1,
["NQNKMY2WTCO63KC2TXMW63DJZ5K4ZSLQX4GH2QA"] = 1,
["D5A6UZ3HA6IDWDBCXNBM5BPIJCA6EXPNPSGABUI"] = 1,
["4S4SRIADAALPF5SC3GTPPNI5QWODQE7KZ3K6VNI"] = 1,
["WXIO4PNNTTXV7QLZVVGXAJI3VTI5TOUV7IIR5YA"] = 1,
["C5CTW7IZA66CO4U4BIDXR4JL2FQCSXLJCMFDNZQ"] = 1,
["W7JRDOFQJ5OE55GGQQNZM5AUJIVSZAQV7PVENQQ"] = 1,
["RV34GWYD7FGJHHNOFDQGZ5R3ZI54V5RYK5J64YI"] = 1,
["D3USYOVYNXEECH3NZJZRHZMANSSE4ZKFQ4SBPMI"] = 1,
["OZRYPROD2FIVEAAFBP4FJOP6XDOIKN34SCGFPJQ"] = 1,
["MB7ESQUY2VFXZVVLDXUW2OGKDJ4CA2DRQM7E7ZA"] = 1,
["TANK5MAZSTZY7SJ53OHKKSW3TPYEPZ7DX76CNAA"] = 1,
["IL5HUHFF2T7EW44BMJ5NAJ6WVDDW2MJBANP7Q6Y"] = 1,
["QCY2GZFIS5BE65BP3UVN5TGSPH2O2N6SMOUCI4A"] = 1,
["FEG6PL5OOMZSELN7E7IFJXXSE4SWAKZ5KE3G75I"] = 1,
["6WBLSNYMRKAMPQWYYNHXFY4SLEASORYFC3ITUMY"] = 1,
["R5ZXVZLYENQIT7QBZ5XTA4QE3VTZRKIO66X2EIA"] = 1,
["KM74GNCN6Z4S5PKBB3RFHKWSWE2IPDMY5V73GPY"] = 1,
["UM6QXRK7UFHIOQLRCQNDHMTMVJASLCWUUVFYXEA"] = 1,
["5QZKBU7ANE7PAZ7KZ5HWA45LRO5SRELTHRDYVJY"] = 1,
["QCSZGPPDPFLTRRSS4WAWTMB24BXJHOM4T5K77SY"] = 1,
["3RJK3VNHHFSECJEQPIQ27FWU5YKWRLFJJIZDMWY"] = 1,
["PKKWUTLAAV4WGSE3NFXYOCZXI427BBBE3C5S6YI"] = 1,
["SGYWOTJB4BB4MUNNDDLK7LX3F2SYMXMRRP5YQUQ"] = 1,
["WE33C7GMR3CDY3BAM5NNS5S6FMJDEZ6VRDOTFEI"] = 1,
["YOUTODNDALCJ7CC4E3JPSWSMYDOGOSBXDV3HZTY"] = 1,
["RODGHYPAHS2W3YMT3BMAOHF6UZO56UVCCPK2XDA"] = 1,
["ZJR66YA4XW4YNV6USIKJTGSIFTGVWTAMQYTJSYY"] = 1,
["RFTDVX2MXU5LUPGWR6IFGPHCQWZTDAX2J6K3H6I"] = 1,
["J3XLQWXYMITILSKBBQ3FXOAWNF3XKHD6AWJTFEY"] = 1,
["K7ULMMRWCA3V54VK7TWW6WIQHBTRE2TVF4EENZQ"] = 1,
["SF6CRZFSB52MRGAZJOFNWAT3NS6LL2C5I4FOPAA"] = 1,
["RWX423SKWLXTTGJ4AWIVCX6R7UVG4VMOLADXT3A"] = 1,
["YHW4QMFYH42CZ73P6UVD7GDCVS4M3PUI5P5JU2I"] = 1,
["M4P34XWTMN7UCOY5CZ2WM4HS4UCTBOCOG34JKGI"] = 1,
["L3HXPPBKN4WDP27UQ56LD4BPVU4EEJD6GJ7QVUQ"] = 1,
["HKVIH6MVITQJXPZQNH5WXD5LXOZ67R6MHHKT5YI"] = 1,
["UKDP46PVEGSJPPBDZPTXANQIZVTTOZBSRCPHJ4Q"] = 1,
["T3SJ26X4NVLYSDADGNQEIUYRZZUVJIVYGP26I3Y"] = 1,
["4NJ7I34KT5K6RSCES2UHWNUHLTNW5F4RJRF3VVY"] = 1,
["EOQMTWYLW5JZ532BYES4J434JM4FSDQEV2SOVNY"] = 1,
["4IESQPTVHOC56KCWOHCLKAPH2EJGLLRNMDO7BOQ"] = 1,
["ILN4TE45WXW42ZTCXDDKHANRCEHJWQNVMPUXPYY"] = 1,
["QV4D3ZZB4DJLY5FIJAXUL45R2T22NROWSMUKZSA"] = 1,
["YOTXPSCBRRVQILPQZ2ZHYXZKIYKADOP6KCJSJBA"] = 1,
["GNRJEN3LLX4FJPFAQCNOQFGSTFBUBPB3R3MTMKY"] = 1,
["BUD5NM6Y2ZUIFMPSXX47X3IEOR6HFWS6FM2YGRQ"] = 1,
["ZDMB6JB2QWCTMB6SJITN2ERLGBHUSY4MR5YC33Q"] = 1,
["LOV6L6VCHV4FU5SDE6JRP3DQE63GXNBELWASIRA"] = 1,
["GOWQTZ4LOOIR6RBOFXEV2VG5WSJZOW37G2LE7WA"] = 1,
["6SBMW6N2NYEITPLZFKBC5KYJ5XXJEA2OIK5565Q"] = 1,
["IZ5RMLCEMIJ2SBWYQ2BSF5L5GPLUNARJUF6DY6Q"] = 1,
["KZCH3NC3ADM5SY2SHVXVRUYRMDX5WNC5JXOEHIY"] = 1,
["7LEKOZ2ZKPBXDPMESRLE7SASXSM7TH5GXSUQWEQ"] = 1,
["TYYVE2ECQ65OHZYZQHN7VC2MLYUO7VNQDUAFLSI"] = 1,
["5IEV3NKC2XNMICEPGT53RAW3W7Z5MVJR5SZBGVI"] = 1,
["HOID7EZ2RMFJTKV367IDX3XKJSOXFMBMXEPN2TQ"] = 1,
["XGYAXRKWOBDREQMHLF7YB3OISTD3CLULQQDLBYY"] = 1,
["D52KMD7Y3IS4HSLQ42UON3LP2A2B3ETWOSX7QVY"] = 1,
["2HWGITOIF3FGKXI2YG22NRDYZMDSDSMOCCIXYIQ"] = 1,
["QGSZA6LTAELEBBXRYLUQNYV3CT77OFJ3QKFNEQQ"] = 1,
["OPCST5OXKK5QVASYWYY4ZIQN6DDTN2VELXZYBQI"] = 1,
["PZGVKIYIYWMTJSUD2BVO7CUNJS53PTSWO6DTYII"] = 1,
["OXNH6WVZ3CQGXXKGWQUP2Y7QB4YPND3VXWDBMXY"] = 1,
["LV53VYQ7C3MOLPYFJJJY26CEXRTYDWXLC2RPSXY"] = 1,
["SXDR24RKCDLH7R44AU5MMOA7LW7EATHCSOO7R6A"] = 1,
["P3Z57YR4VZ7YTHDFF5SSBMSMIALVHMGNSV7NKCQ"] = 1,
["NJNA6FBJYDR6HSYLIPVA22WAIKL6Z5EAHKMYNRY"] = 1,
["6GMXWRLI5PQDUM36SPDLAVHRO6IWNF332O2XZFA"] = 1,
["JCMMVC2W2YSBG4I3F65J3WOMUYBQNENOTVKJQUA"] = 1,
["GL5BETN6MO5XGF5IILI5J72FAD7MEA57R7433EY"] = 1,
["HAJU26Y2HCGWI4TFPJPGL2XKULWKS6KH23YE5BY"] = 1,
["6EFHONZSBY5GZZSCRFAU4GVYERRU3IFZKV6QK5A"] = 1,
["OV7IFPZGTKA5VOQ35NSSXT2T2SGZVHXFKGQJXQQ"] = 1,
["Y3KHDESN7LKBYO6D2YWB5H5KL7Z4HZH7JGL4NRA"] = 1,
["AJDJA5GMRJZRBMKJWM65I44L45SU5JJNAZSMQ5A"] = 1,
["NDRCB37VM6SQQUYKVEW6R7DKABWTKI6HOE4WYSQ"] = 1,
["JJCNNP5AY23MXJDV65HAL7FZPZGBO4J2FEHJTCI"] = 1,
["HRRQJZZWQHDOMDGHSMLRNGFDCMSBK3MMB7FD3JI"] = 1,
["LWPS3H45SDJHAE6KRVS4HHR2ZCOYV4VM5CJJHYI"] = 1,
["D6MLOICQR7GHGZWGOLPBGUSQBVTQV43KOQ3OKQQ"] = 1,
["6U2PWUKDM4NRB6UBEOWVUDCFFBDYRCRDMEMUWRA"] = 1,
["VMPZDTBRLX4QUO5UMS7YTKJPWLISID7UIDYJQKI"] = 1,
["VV7VOOVWQQOHFV6OFTIA2455W2NTVTGMP7A5QII"] = 1,
["GJFIZIDFSDCKSRQPISJRCGCFYHVR5XFZKIFJXFQ"] = 1,
["S4F3Z6Q2JLVDOMIZ5UY32MBRWK5TVX3MSXRMNZQ"] = 1,
["NPCFNEAKO4UCDQQBWBJIQ42WNMGMF2A4XDPUYNY"] = 1,
["ODDUSMXO56VGZQLYSOONHOAAQNC6V5Y474MNTRQ"] = 1,
["27T6CAQ2HEDWZNSRPIH34T6RYIWNIBKRKXBHOWQ"] = 1,
["CJWFFAK6YTFGZETLRMQ4BK3NUDPJJOSR6VQZB6Y"] = 1,
["RFDG4KGAUBLBB3KE4MSMDXRQ5OEV3HCJ2PQWKQY"] = 1,
["AHSZRO56NPNB2KYAJPSNWWXVFQUAACC7QFHOYSA"] = 1,
["UIT7YY5DSBUL76LIHNIXDGAFPQRMJ4DEG2SJ7DY"] = 1,
["J7P2RGQD6QLUAGO4IHI4V6IMJQ762XUWHNB3GUA"] = 1,
["K2NGBMFPD7HPMF4GPBHLRDM2JIOAJ4H7K3PV2RI"] = 1,
["4TMUI4HLQKTTRFDQZ5DXTGNJK56VF6CP7FTRGMQ"] = 1,
["7HKIFNG7L4ZZJNS7UKW5FGW7GQ25GOUBCGPX7MA"] = 1,
["7CDRHDGFUPVPUWZUPH4QPVBLTDOT7UCIFJUOP7A"] = 1,
["EZMF7HRCZ47SV6G3YZVA3NBXQB4OJBVXKWATR3A"] = 1,
["OXD5QP42ICGTOXS7G54FG4NUEZR7O6GX5J46Y2A"] = 1,
["I6BW43SVV7CEQBMKMO2C3Y5K6FNRG3TVM74IN7Y"] = 1,
["UH4J5T2PYY4FDQFEU5WKTO5XNZO2SVMMAOKO3CQ"] = 1,
["TVH3CWLCP2ZVDRQ6P3X2KYCFQ55DWCE3SPQAGZI"] = 1,
["IIOGTOQISICUK5RWYKY55U3KGZFEZBC756WJG4Y"] = 1,
["B5ZEKRMQFTDRVB34LPRRC56COA6P5S3EY37T43Q"] = 1,
["C752TYLJQAJ5SII5V7IAE5E4OQFQ557PTF3U7DI"] = 1,
["YUQCX4I4SJEKBESMLKM7N45B5LNIMHJGDFOIF6Y"] = 1,
["LDS4B5GIT6CQRZ5GR234AUIXL3TBCUICC4MA3EI"] = 1,
["7MKNYHTHACRXPPQXOASUUYBZLH4KBLKT7RRQKDA"] = 1,
["INEBMP2EQ3WPMNBFL4ZSXWHQ7BE455I4V4D2CXQ"] = 1,
["6X4NFNPH4Z3KAT7HTFWSAME3QKOFG77JF3RQV2A"] = 1,
["PGTGM6QBN5YGPIHDIKE5HFYQRWAQES7WXUKVYOI"] = 1,
["PZLBCGIA6JWJ3JZ2WYEPWYX74G6O2DMDMBLLCWY"] = 1,
["QMQXTF4KTDSKQ7XAPRYLNCXXJV6KBIW4UI7LUOA"] = 1,
["6KEI2KCB7HAJXBEDB6GLORTQWHHWSC3N4HAXUKI"] = 1,
["GYWIWBLS7Z5XHWTH2F333YKBZVOLSE3E6XX6FYY"] = 1,
["6HOT5MXLAZ6MFNWSUISLJSXEBBSYLD4BGANY7DI"] = 1,
["JODXLLDVR5PXHJIDVKFXFHSTFBWX25ZN35APEVA"] = 1,
["K74EVXTIPLRE6PD4HK7MCZWWPRECAURZTGS2QNY"] = 1,
["UQ2KYKNS36EKKO4MUH3KRKCU25XRFGS2RI5PGCI"] = 1,
["ZXIGLGEUZRK226L4QLH5Z3CTJMYRKJIAXGWUOQI"] = 1,
["6HCJYFB42EO3HLMXKZMCLIBFSOASUR5NAOXWZCA"] = 1,
["74GW4NHPRGMKXZM5ZQGYXYY2KVEYEFALZNWE7KA"] = 1,
["6TNKJKYTNEUQZQ7A4JZVB3N6OXDKF2LCTEAGU6A"] = 1,
["P7OEXUXFBA3GRS4OERLTX4QEMBC5NVWWOVW2NEI"] = 1,
["GVR6J6MTXAWI27NBMSC753HDQVJOEAPKTYYCFDA"] = 1,
["YN77TE6YUHA36NEFOKBGN2MGTPDJSLGKG7CZKMQ"] = 1,
["WKAEOY4XNJK4SMJHU7C67VGQTQJQFS5QE4N2CTY"] = 1,
["XECBAK7FF64MRYXFAIBNLP5CYZDY5TXHWHFRWVY"] = 1,
["MIY45SAIM3EGGYO2OUXM4Z5ID44NWYQUL5KXFBQ"] = 1,
["UNIINRYSZZYBPVCZMLNSFBJEJJKUM6SEJEL2L4Q"] = 1,
["4ZDKZPYTJLVT7FRKOQJUKNP7L3QQOL2NDCNQ2UQ"] = 1,
["7PBIWB6WMW7QWR556CZGNVMTMZRXDL7TWML52TA"] = 1,
["HXDI2TCFRVREEFLZH3DEBLLQD6EAZRIPNWEVYSI"] = 1,
["3TEZJF3QBQOPVXGN5HRSLBM6VXPVUAD5GF3PWHQ"] = 1,
["EQWUCMV6XM47VTX7JRWADKT3EP22US4IEAW4KRQ"] = 1,
["QCQ2ESJG5CQTTPKHLOD3IHG72VBQF3TYBWVFXNI"] = 1,
["2DHCBAF26XCBBWEAPD3YBP3YQX7LN2LJQS3FK3I"] = 1,
["WOACBYMVLRJJWWV4PJYTPHGDQXVTOOND7C4BAUY"] = 1,
["TDRRSYJG57OUB37U2YSJFVRHECLX33HMFZ2P6SY"] = 1,
["HI434AKSVO7VWTVPMKNC4HN4KYIHZEF4CSNQWWA"] = 1,
["QBRM5P2IMV5L3JDWEMBJ7WXVCJ62N22SUTICBRA"] = 1,
["KQUCPM6S73M44H2CPBVOTRASTJKPDR7R4Q5RCKA"] = 1,
["BLL2ZN2L2EH7K65P2QA4C6HL2TUVDOLC4EOUT7A"] = 1,
["KXFXNLCE6ZMK6TT4WVWLLA3HUCYPSHQH6AG5UPQ"] = 1,
["JT56YMGNSHLR6NNZJCQ7BKT2K2WFMUMSPAPTDJQ"] = 1,
["VYHCUHQGNUWNA4ASKQCRCPQOZTEUHHIRG3RUC3Y"] = 1,
["JVTAL52F73IZCG4256C54AF2ITJ2ZUPCAXRMJ2Q"] = 1,
["UUQSKBJUVQCS7YGJTZM66E3BID4ROO33V45I5RY"] = 1,
["KUWH5MPEHAZFDIQTPAK445BCK4GM75KHIZ2NAYY"] = 1,
["D6YZM7GVGGCJCFX2XNQWBMQAKNCHC5ZJSV7O5LA"] = 1,
["N4HRBMUOD6EBT5HLXYDIU6AYWWIEXTXHKOKFPZI"] = 1,
["XIXCQDG5M7OWCTAE7LIOR3TQFMT7ONUTIEFQDQY"] = 1,
["H42K6UB52YY4DV2N34WD4RN2ONBPQLQ2QVEUAEA"] = 1,
["7K7BGXAJ2EHCVS7LPMTDRRL5XCEU6JSGKLTU7EQ"] = 1,
["ABTOTN67QM45XQGNJM2QO6W53J7UBHBOBAWBPGI"] = 1,
["MLVW7CEMEJKPCP435WI7DI3FXLUOUMHDTHH4SGA"] = 1,
["RMQCYUEDNG6VH52KDTLKVZD7ZCZEJYR3EE4H2SA"] = 1,
["D5REL2HXNGGKOHR5CANHFUSY7D4E4PH4VE34PMQ"] = 1,
["I5NDDFOZ3ZDPUOEVY6NS2OOJZAGCX5CREEGF5BI"] = 1,
["X26RYQOGXKF6SA7D3HRHEUBASWNJDBV5R7FEF3I"] = 1,
["BYGG7BFVW262NJ7OXXHISAUCOZ2I6624DTUDSXQ"] = 1,
["NYZIEXO4VSPYZZA6SX2DDRDGZPT3MAFCLKFXR6Y"] = 1,
["QPK5VEMTNS43XGIXD4LDWSVXDKJQQ5LHGUSK3BQ"] = 1,
["SAUS6KGHYIJ3ZX7K47VD66ZO3QUP32CZVDC7NWI"] = 1,
["D6J57ISY6UGXUGXNZBBJRWAKOPGJHR4B3MJSSQQ"] = 1,
["RF4OI3VNXXZGKZRG7DMVXUFCOSVQ2IU5PL46IAA"] = 1,
["N3X5AU2GMMSN3JZNQAQASJHBW2KH235RLVD7NEI"] = 1,
["3XRTHJDIVUBYQOG4DKWQCPGSLXOCIEB4PR4FWKI"] = 1,
["RGQ6YTFLOFBIVUIGZ23TWJBNXF7SHNSIJMFNKLA"] = 1,
["SV2PHIBZYRGQZOBKOTDITVGMYGZZTBOXX5HQGNQ"] = 1,
["FLSF7FQ32IDPTXSJYCVKAM3UH3MIAVPKNIBNJBI"] = 1,
["SAUS6KGHYIJ3ZX7K47VD66ZO3QUP32CZVDC7NWI"] = 1,
["5WPABLED5KU6HJYPW7YDWELHY2NFRHHY5LG3KTI"] = 1,
["Y5CQFSBJSTB37HZ2ZPHRDW6K2YAP6BAF3BZR3TY"] = 1,
["C643LT7JIMOFKZ4A3YUF353IF4RT62QLOSV3AEQ"] = 1,
["QIVS4NQ5KFRBGJO23ZNZZITNEMZCLPTIACC6LYQ"] = 1,
["XIPHX3SVHVHTSDEXV2B2V4OVX2DK32UWZN6NJVI"] = 1,
["5K6CB7MYTWHYDDNQQM7A7RS7L4YP3H7LVQ7OBEA"] = 1,
["S6VE5CD3KDXWW3HFFKBGPMY736S2HDWP7Y6TGKA"] = 1,
["OATRIHQMXUXXT2UGKX43LD3JXGDL3VUH6ZBRDUQ"] = 1,
["4OB372E4JJSJ25YFO77GYSAQEBZXRFAUPOWZT7Y"] = 1,
["WWZNRW3OUXXRMOHAB7XK262DHMDTHYBL7VPAMQQ"] = 1,
["V4CMYB5E252BF7CPDRAVDVUBGBK7NQFCG7C2QEI"] = 1,
["YJ3OKJOCY37QYA3PU2OQUBM5HXZG4UARBOA2C6A"] = 1,
["QUEIUAK5PS5C3OGRQBUTX7BMPYAPPXTYIC2HYYQ"] = 1,
["IUYLZJ7QSLDTCYA4VUIKR7JENOF4LQARC5XQGAQ"] = 1,
["UCOZRFO3ZFRUUYTPGB7E3QC4JW7LH4OMGS7COEY"] = 1,
["WFKNXABTHQBF3EXBRMJR6O2BGEFL74FEXRTJ4NA"] = 1,
["OVZTYSY7ND7CPXBI7R6BYWPIMKIT2RR2ALEUWWY"] = 1,
["XJYWBXMP7T53IVA6XN2463AX4FM4LICGKK4TTXA"] = 1,
["KZRVKJ7XA3IURDIQ5IGCBOZGWGKM6RUQGR3XNCI"] = 1,
["7MQIOS4YFTR6LQN4CXHB6AYW3NOMTOIZ7OSQX7A"] = 1,
["MRNBBKCWJWVD73I5BWEQPLFFSVIKIZ2IWM62DFI"] = 1,
["JXVZXPVIGXIB3SJY3YMJLDDXIWXDBCMVCKYWQLA"] = 1,
["DGORQQ5MW2FVKHQJSI2INULDJGKXNBWPPFST4GI"] = 1,
["LWDXWB7NDPAYN3RWW3FFGKKAE4JYKXG3GKDULVY"] = 1,
["5KFABC7VZVNZUTXSSGOLDRD7FGFFPN4SKEDRDDY"] = 1,
["CD35N3KKVQ3XF6JA2ZDN55JI7NDAL2UDX62WEJA"] = 1,
["7QAV6SIELMVHI3WLM427YOUXS4T3AO2QEND33VI"] = 1,
["ZBPU4J74JHEY3JHEU2QHNNOPIHJHBX6NUSSLC4I"] = 1,
["CB5T6Y3VOTUBJZM4WENLOOPHKCQWP3AM7OPQNQA"] = 1,
["YND2KF7RTABPXIE2GSR5AENNFKRN37CGICDX5MY"] = 1,
["4LSHTDM7DAC3E657WM2HY7QSXLS52C6OF5QSV4Y"] = 1,
["4OTTAGK5DM65FCM4OW4A6V25UMJMCWLQGODNAMI"] = 1,
["KYVAXGPCUAP4ABAHU47DR5CKCW3NOTI6IWPT5DY"] = 1,
["4DRJC3OUMUUVOCLBGJDPAGLR2ZQIWEB46A65MAI"] = 1,
["FNVFT6NYMSOX6BJIHQYTU2O64L7CJZD5S553BYQ"] = 1,
["LR7H3HXJJE4ZYHELM2MEZFFH33LPULBQSLLBU2I"] = 1,
["BHUWAEMHU66NNJM4WZGR4WXSIXESVHMC2WFLAFQ"] = 1,
["ARDY5YU77M3EAEHN2QN3FQW3ISGYHYM6APIHJLA"] = 1,
["FDFVMA6DGT4N2VKS4A2LOMPPDFH2QSX6Y22UMVA"] = 1,
["6JXMLKSVN3VGVQ4NWFCH2VIKJP7URYE26ZBIT7A"] = 1,
["O32O3V7EDVF4BQSRVISGPAHUCPNISB2JZ3GT6FY"] = 1,
["CRPJYONRLWZ423YSLA7V3ORQH2DQP3INL2YRGIA"] = 1,
["ZBDZJQN3AFVNDYY6ZJPN7YILCLVFRQXOP6LHYFY"] = 1,
["OBGPWIDFKS4U77FD7ON5GYN5VYPP2QSFUV4QL3Q"] = 1,
["UOQWV7E75I2722NLM2WU4WQ36ATJHNKDETJ7UHI"] = 1,
["26PVDHIIKLT5HEBULGDHEOXTDKNH6NFKISLDIWA"] = 1,
["GW6FJE63CWTQACTEVXZZ6XGXR44NSDXDXKIENQY"] = 1,
["HVGOXIJW5RTSJTAOKOXYDMNWEO72D65RDXNORTY"] = 1,
["LWW6HUI6QJXZZCR6K6XHPLPLOX7TMW6ELKHSUSQ"] = 1,
["OOEZYKBPDAGG4BM3FVRAL4UBAPTH3257VXYBRXY"] = 1,
["BWW53XXGFCA5NEFTODF74YMYI6CW2EUS7IV66OI"] = 1,
["NZD5AEGKGLE42PNQBQZLC6GJ7WXJPI2HUAZNJUI"] = 1,
["RALJ35NAL3HBINQ2FKBBT5ZMG5FWBVVZ66S52AA"] = 1,
["MRKPKFSD4M57O4XKQ27XROVSH6M236PFHN5XM2I"] = 1,
["MH67XNWDEDRFRYYLTHFE2FRG4ZVWW36Z5KJZIPA"] = 1,
["VBXI5RWN7IQT6EYJD5QLNQYCBPGWVMWMICGCQNQ"] = 1,
["F5USFXH6TKQUJ225WBXH6QKX62FJ5XNRMB6FW3A"] = 1,
["MIVIOLUFIWIPSJRNUFQI726IPW57HT32OYZKVJY"] = 1,
["QHQBN45NAMRV3T7AXE52BG4EFPKO7TJ6CMF6SHQ"] = 1,
["WCZJJCOEHSSVOTQTM6HATMRJ4A4ST7ATGEOWDJY"] = 1,
["ASN4AL7JK6FPJQQ7MZT25T5W2XLWXXYABVKTAVA"] = 1,
["AZFBX37YMNMIJEPQ5KXBHAOU52VKRPO5QKVOIII"] = 1,
["FJRTINJYQNRKCDYVUHDSIZ4XLQKOWZQO4Y3CPUA"] = 1,
["XIMQN3DKWLGYI4RYRPVHWTTZ6R4BVTYWDDRBDBY"] = 1,
["4XRGY46CXDPWYEYXWBGHXDX6PM5YXLBIVPYM5UI"] = 1,
["E4E74GZ7X7DVGWEXCHVYJ5H3OXCRMSQSZSJQMQQ"] = 1,
["JWR6IISD22PS4XTRK4ZMXS4OE5XQVKHRFHKD4QI"] = 1,
["IOXDWB24VLVNDYRT5U5UAIR4ZS7NG63WS4FE6WA"] = 1,
["3JTCRKKLS3YEUY5WH2KBBHPFVLHAW4OJRIJ4UIA"] = 1,
["IWFW7X76EUXVNUB45A67IJAZ547XC2W7QJ3JMNA"] = 1,
["CPGPYK4I2FH7PCQFLIBQ3BNH67DD36W4TRROMRY"] = 1,
["XI2IQI5TX67JXFV22YUYOBOOK6Y7K7NMIEBV6FI"] = 1,
["A3GXNC77WZHNWOS7MX3MD664NHRGKXZW3MBIV6Q"] = 1,
["VWZBLWJXKCEAS372Q4AA3CX33OFAOGVGAERZYJA"] = 1,
["CMTE57C424OT3PNXWZNKODG5C2KGCZJRE5MK5CQ"] = 1,
["P2TUJIDSHM5A7GGXX63Z5T6JDMCOQGI7FHXTUQQ"] = 1,
["2BICTCL76SQNRAB6PMVYFKMQJMPYPXBKEWSXKTA"] = 1,
["FWCXSJZ4CV6AVVZZ76VSYAYDXVVHLMS4GPLKRYQ"] = 1,
["AKG6TPB2HZZEJGQJWQEAIFS2XBBYGWTBQRF7WPY"] = 1,
["IKXEPQ5PRQOCZHFPSXDJCQ2HVICBGZMBWRKLDRI"] = 1,
["WLNB73XVL2KVTFDFXQLCPCQQMX7PZFG2EJJIDHI"] = 1,
["EM5TR3KUOYNTRILTKOGC2E5SX4FCJEKTUWOT7ZA"] = 1,
["HFNE33PJZP35VCP2UZOM3XWBJPY6SWLBNXVM2RI"] = 1,
["SSNNM4QTEOSMXPKYTUG4NRLFWFWR3KLAAYYLECY"] = 1,
["7BZWNL4455NI3WTILM6TPN6BOD2CEAVPLCE5VVY"] = 1,
["CR7G7YY375P4G7STJFX3NBUEHTRCWGRAO3UR7HA"] = 1,
["FE62DWHPYSDV6UADORW3HBFC235AZ6LQA6W6GCQ"] = 1,
["7NYWWF73WHTQVAZ25DIJUQZYYCC3JI2BLJLFDXI"] = 1,
["MFBSAIUY52EAQBOBLPXUTL2DAK3SE2MDJX6CBFA"] = 1,
["LN4YHSTWSPVKCYPO4Q4UXZHNLQOWPY5URS6R3DQ"] = 1,
["M2364X43D6ULFC5F3TDBLSOUL32RD6SHLCCAQDI"] = 1,
["34KE2MIOUUP5Y2SOKZ2FNEAHYYRUSO5IXC2CQQY"] = 1,
["PHAEAUC36YIO6YQPWDENGKNWQHGQVUY7ITDSXEI"] = 1,
["GNWCRX3XDVZ4LQFS2RBHDYQDSR7ZAIYKMI5NLWI"] = 1,
["MVJOL2Y2XOLXVZEJYVHJV5IXFVON5PA5J2PNSKY"] = 1,
["GCGMDAPE3W2ILEBQEKIBZ43LF24YQ7ILTMDTIYI"] = 1,
["SIWAC2AMACCUTUPLC6GUWKFHHNUJQE4VSB6DGHA"] = 1,
["4LRDKHU2QT3FQ7OKLLH5CURSUCSHFK4FGCDPL3I"] = 1,
["XLH3QLOB7PATMETFW4EISL65FHQ2OZX4FIUBNYI"] = 1,
["67MKXXAYS5HVQFWDEDKKIH46JPV6GW3IZG45I5I"] = 1,
["UEWL5AYASSPVWIPWBC5CXMSKAUWTFGTTY5BKXZA"] = 1,
["NU3336ORS3HIGOCORP2MPATTTS33BQ4C3DPADUA"] = 1,
["LV6TSOZ7BWOPFVBBNEFKITQRPOUMKBXKJ4XHWFQ"] = 1,
["SIDPPQJG7UQ3YYURBU3CDSTTXKG32VSQ5RGQFQI"] = 1,
["WT6FEVQTUKXWALUXRVSSTGXF4OV2OFCAU2CMOUQ"] = 1,
["7O3QECPVI2ILR4NLM3O2SVWIARHDEXY4ZKIFP7Y"] = 1,
["DMHTWBYMQA7QJDVWUNFPS5GD2ZD4HQI2BSQWAVY"] = 1,
["OZWJRR2WJAS2ZV4REOEOXQ76B44U2SJBVRVKPPI"] = 1,
["AZFM7NWJ7PYRWY4CAA3EHVLLBPFPCJ6FKEX7PNI"] = 1,
["N7L2VHBJQHBOTJUXXTL773WWZ2BQCO3IZ6HBZ5Q"] = 1,
["DPCERGHUIFMD3KYUAF4ETN7AJ7BAJ5X5BL3L5BQ"] = 1,
["WJES5YO4I76EA6ETLIKNACMARCYUGBIQEVTEJGA"] = 1,
["2BB7ETGCHMK4GHRUTWECEDWLAMP6FKCS52FPYCA"] = 1,
["XP4MXDLOYXKLCFFCPHYP7OD6RLTMX2NM352NFJY"] = 1,
["NZ47MT2LSJXTRNQR67J4H4ORCIOQCKTRVQ2W6CA"] = 1,
["PMH7RWE7I47K6RKT3OWFVFYOQB4CHRSFEXTKLHA"] = 1,
["L36PTJVAAONK5E7X22ROGCN3UXYPQD7NYYFWEQA"] = 1,
["L4GZO4QJ2VXHSMRRKQTILFO4RIDCIKUB6SFHUHY"] = 1,
["CGOYH2JGYLPR3ELLDE2ULGUYBSU7TA5QX46YFAA"] = 1,
["XKJ2YUWQILZNRZKGT57P6NR4EWIBENEC7LCNZSY"] = 1,
["ERE63ACUKSC4USMF3IL7QOQMWS2WVRNPKYO3VOA"] = 1,
["MCPTU56RF3QPZMHBYNI4EL43WN377LCTDJFNKHY"] = 1,
["SUPGCT3E4AW4JMFD7SSFGND5N4M6J4PSCFPZP4A"] = 1,
["LYOD4EGHMZFHIVFEH6TDI6MFQNZUOR7PENK4WGA"] = 1,
["Y4IZS3O6WXMWBKJC56T3HAY2O2Z4FPOWW2LEJ6I"] = 1,
["RG6E6MPQMUBPQ72XUL2FO7RLPWRA4DUGBMZFBUA"] = 1,
["MVABHBMH4RPLQMHLONESOCFTKSSFIPHXUA2BT6I"] = 1,
["LJSD5YVJUWIH6BCB3K3J6DQDTEWO7SZC6SBBOWA"] = 1,
["RWDDE2HIABZGL3FHADGGPSOEQNSXADNZHTV6D6Y"] = 1,
["FXGIHRBF5YPQHJQBP7FAW2DT2XDRZ6C3QYXIBBI"] = 1,
["WJ7MRU6IOHEQXUOJJC6WRZFRKEDQTPL4ZH5JADQ"] = 1,
["HPQVIS3YARGRRP52D4AOBQHHE6BBFCEODOREYRI"] = 1,
["BLWRZMKZGTUYJ7OXXYPWQH7P3ZNPQKYF4Z3I34I"] = 1,
["W6NVQKMG2THPRTIU3PPEPKWKWHU3I2JDNAK2TTQ"] = 1,
["4Z4JI3P5IYUCN6PYRK7P2ZJTKCCWF6UBVDMEO2I"] = 1,
["O4NSGLR6SC6ZVAQ7FFZJEOER5E7SFWT5B4PLHIQ"] = 1,
["ZEXP4OZWPL73Q7KGQSCSPLWYE6Q4TU27COUCZVY"] = 1,
["QS4L5HKUC3YG4B4IB7MFIE6EQAQ37ZOZOBFYOKY"] = 1,
["3BTXMTRECDLTY2GOK4JSQVGU5FXPZFMZLBATATQ"] = 1,
["Y4NA4LDBGWVXULNUJGRXGTO5RZP2EUISUFOPWLI"] = 1,
["VWLOIKKFQSISCROHWAPJSH4UGTEFPTUCO5C5QMY"] = 1,
["FTALW6HKWZPUOYSUK5XYNYTM3LEATNHQNSXFO7I"] = 1,
["VXECJ3X27RNWJLWLONUFQFL6YU3SF3C4ZDED7CI"] = 1,
["IUTC5IAQ6FFJZTLDUOXKJB4TXNRFW36477X6CKI"] = 1,
["ERLSPU364GVLTZZNWA4TK6KOMW7J5UJ7EKDR55Q"] = 1,
["4TY35XLFT6NZEARKLYNZK45JSDV6IQOW3Z5IAYQ"] = 1,
["RRO6BSYY6SNCXON57Q3CDIDBE4EYQOSK7G5ZKNI"] = 1,
["U73E2M4AZ5N57ZDBU7YYKC4HUKKMKQTW2TNQJYY"] = 1,
["SKDMNAGOA3M733UBZQJ6Y73QRYJLRDKIK5TTPAI"] = 1,
["DE6BLBCKMSXGIHDQCJQPE2OGELMYBV4JX7XYN2Y"] = 1,
["CFCMGRTKETBWV72PC3PBJQ3IULTB2PBRL7WZIUI"] = 1,
["UVOJIELIASCVQ6NCFHV62O4I72ERAKCMOW7EKCY"] = 1,
["SDHLIW2MVMK6FHKUTIFAODGZ2KJOHTQESVMRFZY"] = 1,
["FOPLCHCIHOLNRR3JJBNJ5RQT22IO7FLKVDUVOOQ"] = 1,
["XICQR3OFXPGF4OD4G5DWGX4PBRICKHPZPNSOYKA"] = 1,
["Y3ZAP46IVEMA7FJ2XAY4JVITT2GEDMZ4ZLNKAII"] = 1,
["HFRCQTZZBTI2XQMKMCAHA3KHBQ47VR4ZWQDWY7A"] = 1,
["AFRMLXSDTLXELGK53VLGNFHI36ZKINK6CIZ2MVA"] = 1,
["DMHTWBYMQA7QJDVWUNFPS5GD2ZD4HQI2BSQWAVY"] = 1,
["X3TGT2XM6AH7XGDZ63VZ6PXRFBUZA2FMBV3D4RA"] = 1,
["FIQVSWZ2WHCNKHYXOC4Z2BPBBJ6ESAT2JGJ5OZY"] = 1,
["WEGK5YTOBJOL5CIMSQYFCVEVLP5XEEPEMNVW5HA"] = 1,
["2DEW77V64VWIMIC55VU7NFEIAZ66DGZPXI42ZCI"] = 1,
["XZBC5O6A6SR4A5GFIDVITYC2FIKA6JDJ4RHJDFQ"] = 1,
["33KCLZBNAL62DDRRB6SHJRUOGF3EAPATBNQFWYA"] = 1,
["2ZJ5ZKFIPHKHE2R5VHI6DD5RMJVQVCQLD7F4GIA"] = 1,
["QAFTDPKRZVYWJ6L7EDSGVYCLYA6OQTZVXZMNL2Q"] = 1,
["Q2JDSD7BTTOLXBGB7XFFU5WASLI44DMF7JTP2QI"] = 1,
["G6PZ3UVXVZTKXLGA4H74FZEY5XMQ2MLV4V2CMVI"] = 1,
["QOWUIOZVY4WFLP2Y32DBRVWZYFC4UOS5THGCKSY"] = 1,
["MI4GHBNLLVDYL6SZCSADJT4E65GMAOTFD3OYTIA"] = 1,
["JCYEVZ6AKLG7UARD5NMPKVLSYGKVU7LGUHOFIZI"] = 1,
["CHNYMGWRJ7VE43DLOJKF2MZYLP57WK33DNBB3HQ"] = 1,
["VWUMFD5U5BHX2YVK7GNIK56AUUXZYNJO36RUV2A"] = 1,
["VJI3S4TZOIKHYT6GOF2PXX4NFZXLZU7PN3WHFDI"] = 1,
["NVIQZ7I7B4MBVWGOWXDANJQLM3NPGBUYHFFOAUQ"] = 1,
["VMYS7VGIR6CKU76GQ7S22QZUE6Y7W5QVQOYGWSQ"] = 1,
["V6O4CJNLQTQAIAWA43DOQLXVHK4H6VRTGH2JOSI"] = 1,
["R3G77OL3UBPRXOBJKJDP2MYW4R6G77PL5MLBIOA"] = 1,
["OEL7LP26SWAVFFAMWEF254JYQY2AW2UXRYZOYKA"] = 1,
["BMRZFIVW6NUYMGITPPINYUTLNL7ZD6HSP6OJ33Q"] = 1,
["3AIJC5UXR56VR4YH5SODB7UIKMLZHEOKETKZC6A"] = 1,
["UDYXF755Q64VZI5EKZXD2PNXZC5L3P34UWMKLOI"] = 1,
["EV2YKQ47EFHPQLASP4URHHM6YTDGWZCYVFOCZQY"] = 1,
["VHZRXZJFESQNZETDJQU4CUZIOEIKZDP4W6W2P6Q"] = 1,
["OUHUDVYWLNA6HRU6AU3RUWNJ7MHPX2ZXCYEHNII"] = 1,
["QPTNUT5HNARIU6XHRM5WU3EEWUA6YIZTTEE6QMA"] = 1,
["375NLLDQLSNY3UURTSGSN2Q2QRHHX3QVSJALRDA"] = 1,
["4JPQMAYC5PJWMPO2OTH2MFTPZFFSUZZNQM2ZLBQ"] = 1,
["VTWDYSJFFPOXO44QVUA74HBCFP4LJQW5T7YVIFI"] = 1,
["NYWEHDMVA6FRQKXEJ4VFCF7RCOEA2BKC6PKHW2Y"] = 1,
["CJGNHWR2SUI4ASPIFTQPDSHIAAS7GZ63KALW7WY"] = 1,
["DMHI5FQKHY2W3ZMWLMBFL47DWAZR6KSJIEHI6XY"] = 1,
["IJWYEVDA2BQPOJMTAQLBK7TAJMXUUQSEDEIN5NQ"] = 1,
["HCN64HCE6TMH5NQPN2XMUXVMUEKSGOGUUFA3ESQ"] = 1,
["YH5SPZHPASK3B3LUAJ3PILQJIZKT4Z6EOUVWJEI"] = 1,
["NLPBT6WBDKRESZYHRQ4AU3V2P2NRGOJEXHHKGYY"] = 1,
["HMXTSPU3W3JQMJQNKKUJ4MWQ64BPJFD5CNTLDAY"] = 1,
["ISBMAKP2S2ZYMDEHQVP3EBZHHV5OA7M2KO7ODIA"] = 1,
["7OPUWZ3K5K2EDXUOUHSNP7PXL5MB4MRMOLEN3NQ"] = 1,
["6KPSEOAFJNW7RDEGLQWT4TRJGWBKTFLVMAEYKVA"] = 1,
["PWGMQZNJV6FVKKTCFC4WZIYAGXEEZQLANXM3KHQ"] = 1,
["UZ3XYJPKQU4OCGSHZPRNPONLO5CQLU2IXWUWMZQ"] = 1,
["UYNXPRYYTZ3TDSMMXGJVZWWN7EOMFX7NEVSJPOA"] = 1,
["KAG7MAELB57IZSECVUN4U36GHE44U2H22KQ3KHY"] = 1,
["HU5GZO7BZ5J7HX3PH5DAD43I7RWI77XH2VOHL7Q"] = 1,
["HBOMQXPN52TCJPO553XNIHMFWH3NRAU6TH54LTI"] = 1,
["F5EIPB25PZKQ7SQRZGCA3EMMD5POGPZ6UDB26UI"] = 1,
["ABYYYQR5T7FNURRY67WVKWG6JBJBJF2ZKF5UEHY"] = 1,
["43B5SYNKXDE6WIKNBALN3MVKK6VVBLCGYEEQ43Y"] = 1,
["CMWJUUBMRTNUKYEJS7JGMR7P5TRC3OVZHGFF5CQ"] = 1,
["JJWXB6TN5YHTALU7TXX4J56K4DNFZYO5UQUC46I"] = 1,
["EYU32BEGYHSHDI34VBEYE72ANNCMLOBZAQS72WA"] = 1,
["5HF6NJONALMNTZSAE23XCI3ZFGDCYN35PUPJLDI"] = 1,
["R4UC5II5SYIE7TDABDLB2XN53UVHHFVQINO7ZDA"] = 1,
["SS6X4IRA5DNLJVMRZNOBR4FPOQJWDFSCCK6JC6A"] = 1,
["GENUGH4GB5RROKEX7WCG2DAIKX5XTKEPWZVC5RQ"] = 1,
["HNAQCWCRZ2CUMWI75QR47KMQAIJSD2JE4DESG6Q"] = 1,
["PYSRAVWGOHDVXUW2AVPMPKIRW3H4NAF4Z4MT6EQ"] = 1,
["ESZ57H3L5ECK2TYKQGRKZW3ADRZJ4S6BE6NZI7A"] = 1,
["YNGVZ44QNFXUPQU5TCILB63GYAQ6B4NOM3NFG6Y"] = 1,
["7RWQJKTLEHVGXZ2FD46LEF7HSYJHJGMSGICVKPY"] = 1,
["22N7VFTL2K3GAHIXX6D3J5RR2JDGHISDDXFEQZY"] = 1,
["3MXFXGPU4UQCKYVGBYUSVEQBRTUWZMES24EUKQQ"] = 1,
["EMPMUW5MKL3N3DOEEINAFO7WHTX2F33XRTRHXPA"] = 1,
["MTTIOK76ZS5TYYPXX2VRVFYDJC5IKLBIDA3QVOA"] = 1,
["5SRCWFLXJSVUSBYZ3PKRKQCZBDSIL4I6RZOQMOY"] = 1,
["FT6T7NCIKICITZCUFBYWYRTMBXPA4OCYSLH5PUA"] = 1,
["Y4TGCSNA3VSBTPBYMQOZGS7BZHH6J7JVZD7KKHQ"] = 1,
["JYD747D6EBRM42FS3PEOQPVX77NTAQBTZGB6AJI"] = 1,
["VE7KMSN4UJOPV6735NUKMW7C2KBZDGZHEWZU2QQ"] = 1,
["2GNEXYKMSA77FXRJAWWCI3324YAHUOA5DOOQU5Q"] = 1,
["JVR34NARFMBY36WLC6BJ7VMIEPT763XAVWACN2Y"] = 1,
["XY5FGVYKG2JQNQY2KK5CYEWHTF5HGJVOW6QASZI"] = 1,
["2LAYTMWQ4JSXPRAURQISPLE7C5AWSV5SFZPRDHY"] = 1,
["XY5FGVYKG2JQNQY2KK5CYEWHTF5HGJVOW6QASZI"] = 1,
["2PQLWFHCPW4LLM44MIZBZMUOYLCHJSTFLW3CIJQ"] = 1,
["JHN5OJNT2YFNCKX3GB5NZL6NL6JYHV4IPM2ETZY"] = 1,
["ZXXLLBTCEFHZBABTFYTLZBVZNMH35LDKYIRAXAY"] = 1,
["A4Y5OQ54WK76SQXCSG2V5HZ7UERJM47RJKO7HUA"] = 1,
["GRSV2CGXJD64PQTZOUBNFSSHJ5BJ5QUVSNC3Y3I"] = 1,
["TGEOFRFGYWBI6OWQQJYGGAHZVUUIWPIOYE5PMZY"] = 1,
["MIUOCQAHMCH6JCHK3TQUVMAF5JALKPUXAH2AG4A"] = 1,
["6C6BWOOSJ6XUDRGDVRST7C2XE4BY2LSJ53X4U6Y"] = 1,
["CZKOG6XTCX3PSVUHGETUDRML2NAPZ7YVJ7PLHAY"] = 1,
["LBNDSRQRHJAZUBJPOBAP3T5KFFXPGYBKVKTFJDI"] = 1,
["CZJHGPMZMRC5YADUMST3U62SAS6BORC25LQBGFQ"] = 1,
["6GCSJZU6C3KCKG457GMGWHDM6QDDOP5YJFEKSSY"] = 1,
["CJXKX7S73ESHV76XGCWLOP27IBQPT3TEFUMZMKI"] = 1,
["4CLWMFQO3KX7ZCPMYCWUABLIDECJSPPRCWIFCCY"] = 1,
["6VEOZ3527AQ36Y2EXOQ4KCAYX2KP7AGUGBTFCCI"] = 1,
["LOVUBYPHXZFVYO6HZMYT7YTDOAYM5SUZLSDZIVI"] = 1,
["XSI5X63F3UKSGLB5Z4MEPBUWTD4AWSKTT63QSMQ"] = 1,
["XM3LRRZVAJIBG46FT67YAJY5K6EI6MGI6AKGIPY"] = 1,
["V6YK2ZN66DAPKWKX75DC4WDCGZ5OINY4Y7WBUDI"] = 1,
["CLMDGQPYF4RQJIDS72BH7BAVEZ3FPARW6K6TBDA"] = 1,
["MUAHGAC4ABDQA4QAMUAHSACMABUQA3QANMAEIAA"] = 1,
["7OCPQKIMT4M2XUWNAKMLUFCZK65WOGDF6ZUT74Q"] = 1,
-- немного вирусов
["VIUL6UFMFGX3TUYV4OF5EHNGUEWFAVTPFH5EPAA"] = 2,
["TJ4KJEWDFDWUOOFULQQXGZMF4R4J6OVOK4P45GI"] = 2,
["EJU3CEHQ2GUB72VGWYFWA5PBIUIHE6HSI2IG5EY"] = 2,
["PFZAYCJL3KPV5EOFPKF2EZBYYQB2RRCXUIQAOKA"] = 2,
["P7JSV4VIV2CANLWVIUWJP4636X4Q72IMDTP3FGA"] = 2,
-- немецко-фашистский фильм "Вечный жид" запрещён к распространению
["MTZRIVF7YNQAAXR77F4OGW2RPATLGNM72EUPGAA"] = 5,
["CDTK3BJ4ZVO74VA6K4U5SBE3B7X767CFADR4OYY"] = 5,
["OXPFUAQEEVDR67YPDKFLEYQF6K7UO6LKVZODCBY"] = 5,
["NGBEJG67JKKTIE4KM5E6ZTV2U22UCI2QVO36SHQ"] = 5,
["BIWX376KAJXE2YBWPF4VUUEDMH5MVRI7DLQ5U2Y"] = 5,
["A3KGCQIWFOH5KWX26ZJQUKJW3X6QWDPOF4BSCDA"] = 5,
["SNNXBPG4SRIE5BHO32IF7R3TGNX2AOBGHDGYXLA"] = 5,
["D77LGYLJYDJADUVGBAFL5MY4HFOMAQG3GDGUGDA"] = 5,
["GXQNYUY33SIOE3RPKQXURBMRRE3Z7WLYXS2WMDA"] = 5,
["7NY2OPL4SP6ZTB3GD7EZRRS4BFUKPAMZAOYJMLY"] = 5,
["5M46AA2BVM2ZANPQRZJHXSSOF76S4Y2RTIWWJLQ"] = 5,
["AH7QAKKCNNAK3RMOLXBB3CFQZH2YEVO3QNPGZ5Q"] = 5,
["MTZRIVF7YNQAAXR77F4OGW2RPATLGNM72EUPGAA"] = 5,
["QH2NMI7FFTK4LNCUINKBEJDAMQXF4V56DNTG2LQ"] = 5,
}

-- TTH файла нулевой длины. Практика показывает, что его время от времени умудряются
-- добавлять в базу
zero_tth = "LWPNACQDBZRYXW3VHJVCJ64QBZNGHOHHHZWCLNQ"

-- map tth to tth type
badtth = { }
-- map tth to fkey
badtthfkey = { }
-- timer iterator
ti_cur = 0
-- timer iterator max (300 seconds between reloads)
ti_max = 300

-- verlihub ban flags
eBF_NICKIP = 1
eBF_IP = 2
eBF_NICK = 4

-- Счётчики
count_autoban = 0
count_handban = 0
count_byop = {}
start_time = 0

function VH_OnOperatorCommand(opnick, data)
  class = UserClass(opnick)
  if string.find(data, "[%!]banporno") then
    res, _, nick, file = string.find(data, "[%!]banporno (%S+) (.+)")
    if not res then
      MsgUser(botname, opnick, "ERROR: неправильный синтаксис, надо: !banporno ник путь/к/файлу")
      return 0
    end
    SilentBan(nick,botname,badmsg[1]..": "..file,badtime[1])
    count_handban = count_handban+1
    if count_byop[opnick] == nil then
      count_byop[opnick] = 0
    end
    count_byop[opnick] = count_byop[opnick]+1
    return 0
  end
  if string.find(data, "[%!]banvirus") then
    res, _, nick, file = string.find(data, "[%!]banvirus (%S+) (.+)")
    if not res then
      MsgUser(botname, opnick, "ERROR: неправильный синтаксис, надо: !banvirus ник путь/к/файлу")
      return 0
    end
    SilentBan(nick,botname,badmsg[2]..": "..file,badtime[2])
    count_handban = count_handban+1
    if count_byop[opnick] == nil then
      count_byop[opnick] = 0
    end
    count_byop[opnick] = count_byop[opnick]+1
    return 0
  end
  if string.find(data, "[%!]banfake") then
    res, _, nick, file = string.find(data, "[%!]banfake (%S+) (.+)")
    if not res then
      MsgUser(botname, opnick, "ERROR: неправильный синтаксис, надо: !banfake ник путь/к/файлу")
      return 0
    end
    SilentBan(nick,botname,badmsg[3]..": "..file,badtime[3])
    count_handban = count_handban+1
    if count_byop[opnick] == nil then
      count_byop[opnick] = 0
    end
    count_byop[opnick] = count_byop[opnick]+1
    return 0
  end
  if string.find(data, "[%!]banch") then
    res, _, nick, file = string.find(data, "[%!]banch (%S+) (.+)")
    if not res then
      MsgUser(botname, opnick, "ERROR: неправильный синтаксис, надо: !banch ник путь/к/файлу")
      return 0
    end
    SilentBan(nick,botname,badmsg[4]..": "..file,badtime[4])
    count_handban = count_handban+1
    if count_byop[opnick] == nil then
      count_byop[opnick] = 0
    end
    count_byop[opnick] = count_byop[opnick]+1
    return 0
  end
  if string.find(data, "[%!]banforbidden") then
    res, _, nick, file = string.find(data, "[%!]banforbidden (%S+) (.+)")
    if not res then
      MsgUser(botname, opnick, "ERROR: неправильный синтаксис, надо: !banforbidden ник путь/к/файлу")
      return 0
    end
    SilentBan(nick,botname,badmsg[5]..": "..file,badtime[5])
    count_handban = count_handban+1
    if count_byop[opnick] == nil then
      count_byop[opnick] = 0
    end
    count_byop[opnick] = count_byop[opnick]+1
    return 0
  end
  if UserClass(opnick) > 4 then
    if(string.find(data,"^[%!]re") or string.find(data,"^[%!]reload")) then
      MsgUser(botname, opnick, "Reloading forbidden TTH list...")
      LoadTTH()
      -- Здесь должно стоять 1, так как эта команда должна быть обработана другими скриптами и хабом!
      return 1
    end
  end
  if(string.find(data,"^[%!]addtth") and (class>=min_class_addtth)) then
    res, _, tth, tthtype, comment = string.find(data, "^[%!]addtth%s(%S*)%s+(%d+)%s*(.*)")
    if not res then
      MsgUser(botname, opnick, "Syntax: !addtth TTH тип [комментарий] (например, !addtth 123456789012345678901234567890123456789 1 Нелёгкая эротика.avi)")
      return 0
    end
    if tth == "" then
      MsgUser(botname, opnick, "TTH не указан (это каталог?)")
      return 0
    end
    if tth == zero_tth then
      MsgUser(botname, opnick, "Это TTH файла нулевой длины, не надо его добавлять, хуже будет")
      return 0
    end
    if (not (string.len(tth) == 39)) or (not string.match(tth, "^[A-Z0-9]+$")) then
      MsgUser(botname, opnick, "Неправильный TTH")
      return 0
    end
    if badtth[tth] == nil then
      q = "INSERT INTO "..tth_tbl.." (tth, type, comment, fkey) VALUES ('"..tth.."','"..tthtype.."','"..sqlesc(comment).."',MD5(CONCAT(RAND(),NOW(),'"..tth.."')))"
      res, _ = VH:SQLQuery(q)
      if not res then
        MsgUser(botname, opnick, "Error in query: "..q)
        MsgUser(botname, opnick, "Добавление TTH "..tth.." не удалось")
        return 0
      end
      badtth[tth] = tonumber(tthtype)
      MsgUser(botname, opnick, "TTH "..tth.." добавлен в базу по причине: "..badtypes[tonumber(tthtype)]..", комментарий: "..comment)
      -- FIXME just get tthfkey for new tth from database
      LoadTTH()
      -- Форсировать пассивный поиск этого TTH. Приводит к существенным неудобствам для добавляющего, поэтому отключено.
      --VH:SendDataToAll("$Search Hub:"..botname.." F?T?0?9?TTH:"..tth.."|", 0, 10)
    else
      MsgUser(botname, opnick, "TTH "..tth.." уже есть в базе")
    end
    return 0
  end
  if(string.find(data,"^[%!]deltth") and (class>=min_class_deltth)) then
    res, _, tth = string.find(data, "^[%!]deltth%s+(%S+)")
    if not res then
      MsgUser(botname, opnick, "Syntax: !deltth TTH")
    else
      if badtth[tth] ~= nil then
        --VH:SQLQuery ("DELETE FROM "..tth_tbl.." WHERE tth='"..tth.."'")
        VH:SQLQuery ("UPDATE "..tth_tbl.." SET type=0 WHERE tth='"..tth.."'")
        badtth[tth]=nil
        MsgUser(botname, opnick, "TTH "..tth.." успешно удалён из списка запрещённых")
      else
        MsgUser(botname, opnick, "TTH "..tth.." не находится в списке запрещённых")
      end
    end
    return 0
  end
  if(string.find(data,"[%!]checktth") and (class>min_class_checktth)) then
    res, _, tth = string.find(data, "[%!]checktth%s+(%S+)")
    if not res then
      MsgUser(botname, opnick, "Syntax: !checktth TTH")
    else
      tthtype = badtth[tth]
      if tthtype == nil then
        MsgUser(botname, opnick, "TTH "..tth.." не находится в списке запрещённых")
      else
        MsgUser(botname, opnick, "TTH "..tth.." (FK "..badtthfkey[tth]..") запрещён: "..badtypes[tthtype])
      end
    end
    return 0
  end
  if(string.find(data,"[%!]checkfk") and (class>min_class_checktth)) then
    res, _, fkey = string.find(data, "[%!]checkfk%s+(%S+)")
    if not res then
      MsgUser(botname, opnick, "Syntax: !checkfk FK")
    else
      q = "SELECT tth,type FROM "..tth_tbl.." WHERE fkey="..sqlesc(fkey)
      res, rows = VH:SQLQuery(q)
      if not res then
        MsgUser(botname, opnick, "Error in query: "..q)
        return 0
      end
      if rows<1 then
        MsgUser(botname, opnick, "FK "..fkey.." не находится в списке запрещённых")
        return 0
      end
      res, tth, tthtype = VH:SQLFetch(0)
      MsgUser(botname, opnick, "TTH "..tth.." (FK "..fkey..") запрещён: "..badtypes[tonumber(tthtype)])
    end
    return 0
  end
  if(string.find(data,"[%!]stat") and (class>=min_class_stat)) then
    st = "\nЗапрещённые файлы по типам:"
    q = "SELECT COUNT(tth),type FROM "..tth_tbl.." WHERE type>0 GROUP BY type ORDER BY type ASC"
    res, rows = VH:SQLQuery(q)
    if not res then
      MsgUser(botname, opnick, "Error in query: "..q)
      return 0
    end
    for i=0,rows-1 do
      res, cnt, tthtype = VH:SQLFetch(i)
      st = st.."\n   "..badtypes[tonumber(tthtype)]..": "..cnt
    end
    st = st.."\n\nСтатистика банов:\n   "..string.format("%-15s",botname..": ")..tostring(count_autoban).." (автобан)"
    for op in pairs(count_byop) do
      st = st.."\n   "..string.format("%-15s",op..": ")..tostring(count_byop[op])
    end
    delta = os.clock() - start_time
    st = st.."\n\nВсего автобанов: "..tostring(count_autoban).." ("..string.format("%.2f",count_autoban*3600/delta).." бан/ч)"
    st = st.."\nВсего ручных банов: "..tostring(count_handban).." ("..string.format("%.2f",count_handban*3600/delta).." бан/ч)\n"
    --st = st.."\nПрошло "..tostring(delta)
    MsgUser(botname, opnick, st)
    return 0
  end
  return 1
end

function VH_OnParsedMsgAny(nick, data)
  ip = GetIp(nick)
  local res, _, req, file, tth = string.find(data, "^$SR%s(%S+)%s(.+)\5.+\5TTH:(%S+)%s")
  if res then
    if badtth[tth]~=nil then
      tthtype = badtth[tth]
      if info_url ~= nil then
        info = info_url..tth.." "
      else
        info = tth
      end
      MsgOps(botname, "Автобан: "..nick.." "..ip.." (TTH: "..info..", "..badmsg[tthtype]..": "..file.." FK:"..badtthfkey[tth]..")", min_class_autoban)
      SilentBan(nick,botname,badmsg[tthtype]..": "..file.." (FK:"..badtthfkey[tth]..")",badtime[tthtype])
      count_autoban = count_autoban+1
    end
  end
  return 1
end

function VH_OnTimer()
  if ti_cur == 0 then
    LoadTTH()
  end
  ti_cur = ti_cur + 1
  if ti_cur == ti_max then
    ti_cur = 0
  end
  return 1
end

function Main()
  res, botname = VH:GetConfig("config","hub_security")
  VH:SQLQuery("CREATE TABLE IF NOT EXISTS "..tth_tbl.." (tth CHAR(39) NOT NULL DEFAULT '???' PRIMARY KEY,type TINYINT NOT NULL DEFAULT 1,comment VARCHAR(255) NOT NULL DEFAULT '',fkey VARCHAR(32) NOT NULL UNIQUE)")
  VH:SQLQuery("ALTER TABLE "..tth_tbl.." ADD COLUMN fkey VARCHAR(32) NOT NULL")
  VH:SQLQuery("UPDATE porno_tth SET fkey=MD5(CONCAT(RAND(),NOW(),tth)) WHERE fkey=''")
  VH:SQLQuery("ALTER TABLE "..tth_tbl.." ADD UNIQUE KEY fkey (fkey)")

  res, rows = VH:SQLQuery("SELECT COUNT(*) FROM "..tth_tbl)
  res, cnt = VH:SQLFetch(0)
  cnt = tonumber(cnt)
  if cnt < 1 then
    for tth,tthtype in pairs(badtthinit)
      do
        VH:SQLQuery("INSERT INTO "..tth_tbl.." (tth, type, comment, fkey) VALUES ('"..tth.."','"..tthtype.."','',MD5(CONCAT(RAND(),NOW(),'"..tth.."')))");
      end
    end
  start_time = os.clock()
  return 1
end

function Debug(msg)
  if debug then
    MsgUser(botname,admin,"DEBUG: "..msg)
  end
end

function ip2long(ip)
  if ip then
    local res, _, ip1, ip2, ip3, ip4 = string.find(ip, "(%d+)%.(%d+)%.(%d+)%.(%d+)")
    if res then
      return ((tonumber(ip1)*0x100+tonumber(ip2))*0x100+tonumber(ip3))*0x100+tonumber(ip4)
    end
  end
  return 0
end

function LAN(ip)
  ipmin=ip2long("10.0.0.0")
  ipmax=ip2long("10.255.255.255")

  local ipl=ip2long(ip)
  if ipmin<ipl and ipl<ipmax then
    return true
  end
  return false
end

function SilentBan(nick,opnick,reason,time)
  ip = GetIp(nick)
  if ip then
    kreason = "You are being kicked because: "..reason
    MsgPm(botname, nick, kreason)
    if ban_strategy == 0 then
      VH:Ban(nick, opnick, reason, time, eBF_NICKIP)
    elseif ban_strategy == 1 then
      if LAN(ip) then
        VH:Ban(nick, opnick, reason, time, eBF_NICKIP)
      else
        VH:Ban(nick, opnick, reason, time, eBF_NICK)
      end
    else 
      VH:Ban(nick, opnick, reason, time, eBF_NICK)
    end
  end
  VH:CloseConnection(nick)
end	

function LoadTTH()
  badtth = {}
  badtthfkey = {}
  res, rows = VH:SQLQuery("SELECT tth,type,fkey FROM "..tth_tbl.." WHERE type!=0")
  if not res then
    Debug("ERROR query in LoadTTH")
    return 0
  end
  for x=0,rows-1 do
    res, tth, tthtype, fkey = VH:SQLFetch(x)
    badtth[tth]=tonumber(tthtype)
    badtthfkey[tth]=fkey
  end
  return 1
end

function sqlesc(q)
  return string.format("%q",q)
end

